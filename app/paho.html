<!DOCTYPE html>
<html>
	<head>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>
		<script type="text/javascript">
			var mqtt;
			var reconnectTimeout = 2000;
			var host = "10.135.16.54";
			var port = 9883;

			function onConnect () {
				console.log("Connected");
				//mqtt.subscribe("hospital/#");
				var message = new Paho.MQTT.Message("Hello from javascript");
				message.destinationName = "hospital/";
				mqtt.send(message);
			}

			function onFailure () {
				console.log("Connection attempt to " + host + ":" + port + " failed");
				setTimeout(MQTTConnect, reconnectTimeout);
			}

			function onMessageArrived (msg) {
				var out_msg = "Message received: " + msg.payloadString + "<br>";
				out_msg = out_msg + "Message received topic: " + msg.destinationName;
				console.log(out_msg);
			}

			function MQTTConnect () {
				console.log("Connecting to " + host + ":" + port);
				mqtt = new Paho.MQTT.Client(host, port, "/ws", "clientjs");
				var options = {
					useSSL: true,
					timeout: 3,
					onSuccess: onConnect,
					onFailure: onFailure,
					userName: 'infoscreen',
					password: '5k1nnyL4773',
				};
				mqtt.onMessageArrived = onMessageArrived;
				mqtt.connect(options);
			}
		</script>
	</head>
	<body>
		<script type="text/javascript">
			MQTTConnect();
		</script>
	</body>
</html>